---
base_url: 'https://gitlab.com/user/docker-repo'
docker_repo: 'user/repo'
active: false
# (define below the global build arguments, if applicable)
args:
  BUILD_DATE: '{defaults[build_date]}'
  COQ_TAG: '{matrix[coq]}'
  MATHCOMP_VERSION: '{matrix[mathcomp]}'
images:
  - matrix:
      coq: ['dev']
      mathcomp: ['1.11.0']
    build:
      nightly: true
      # (relative path that notably contains the .dockerignore file)
      context: '.'
      dockerfile: './stable/Dockerfile'
      # (unnneeded here, as these args are defined globally)
      # args:
      #   COQ_TAG: '{matrix[coq]}'
      #   MATHCOMP_VERSION: '{matrix[mathcomp]}'
      tags:
        - tag: '{matrix[mathcomp]}-coq-{matrix[coq]}'
        # to remove on next release
        - tag: 'latest-coq-{matrix[coq]}'
  - matrix:
      coq: ['8.12', '8.11', '8.10', '8.9', '8.8', '8.7']
      mathcomp: ['1.11.0']
    build:
      context: '.'
      dockerfile: './stable/Dockerfile'
      # (here again, global-defined args are enough)
      tags:
        - tag: '{matrix[mathcomp]}-coq-{matrix[coq]}'
        # to remove on next release
        - tag: 'latest-coq-{matrix[coq]}'
  - matrix:
      coq: ['8.11', '8.10', '8.9', '8.8', '8.7']
      mathcomp: ['1.10.0']
    build:
      context: '.'
      dockerfile: './stable/Dockerfile'
      # (here again, global-defined args are enough)
      tags:
        - tag: '{matrix[mathcomp]}-coq-{matrix[coq]}'

# For more examples, you can have a look at one of these YAML specs:
# https://gitlab.com/coq-community/docker-base/-/blob/master/images.yml
# https://gitlab.com/coq-community/docker-coq/-/blob/master/images.yml
# https://gitlab.com/math-comp/docker-mathcomp/-/blob/master/images.yml
